<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>iSensor-SPI-Buffer: reg.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Analog-Devices-Logo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">iSensor-SPI-Buffer
   &#160;<span id="projectnumber">1.15</span>
   </div>
   <div id="projectbrief">Firmware for the iSensor-SPI-Buffer board to enable full throughput buffered data capture on Analog Devices IMUs</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d9edf6c004b4a7ff14fe9ae7a92214ee.html">firmware</a></li><li class="navelem"><a class="el" href="dir_344ad9cf7012f4665e17c8bfb6616899.html">Core</a></li><li class="navelem"><a class="el" href="dir_6fab3234299e4772a3d79f4ae41b7a51.html">Src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">reg.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>iSensor-SPI-Buffer register interfacing module. Called by user SPI and USB CLI  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="usb_8h_source.html">usb.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="reg_8h_source.html">reg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="imu_8h_source.html">imu.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sd__card_8h_source.html">sd_card.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="buffer_8h_source.html">buffer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flash_8h_source.html">flash.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="data__capture_8h_source.html">data_capture.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="user__spi_8h_source.html">user_spi.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dfu_8h_source.html">dfu.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dio_8h_source.html">dio.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timer_8h_source.html">timer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="user__interrupt_8h_source.html">user_interrupt.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="isr_8h_source.html">isr.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for reg.c:</div>
<div class="dyncontent">
<div class="center"><img src="reg_8c__incl.png" border="0" usemap="#areg_8c" alt=""/></div>
<map name="reg_8c" id="areg_8c">
<area shape="rect" title="iSensor&#45;SPI&#45;Buffer register interfacing module. Called by user SPI and USB CLI" alt="" coords="575,5,626,32"/>
<area shape="rect" href="usb_8h.html" title="Header file for iSensor&#45;SPI&#45;Buffer USB command line register interface." alt="" coords="837,80,892,107"/>
<area shape="rect" href="reg_8h.html" title="Header file for iSensor&#45;SPI&#45;Buffer register interfacing module." alt="" coords="917,80,967,107"/>
<area shape="rect" href="imu_8h.html" title="Implementation for iSensor&#45;SPI&#45;Buffer IMU interfacing module." alt="" coords="403,80,457,107"/>
<area shape="rect" href="sd__card_8h.html" title="Header file for iSensor&#45;SPI&#45;Buffer SD card interfacing and script execution module." alt="" coords="5,80,84,107"/>
<area shape="rect" href="buffer_8h.html" title="Header file for iSensor&#45;SPI&#45;Buffer buffer data structure module." alt="" coords="482,80,546,107"/>
<area shape="rect" href="flash_8h.html" title="Header file for iSensor&#45;SPI&#45;Buffer flash memory interfacing functions." alt="" coords="571,80,631,107"/>
<area shape="rect" href="data__capture_8h.html" title="Header file for iSensor&#45;SPI&#45;Buffer autonomous IMU data acquisition module." alt="" coords="1043,80,1151,107"/>
<area shape="rect" href="user__spi_8h.html" title="Header file for iSensor&#45;SPI&#45;Buffer user SPI (slave SPI) module." alt="" coords="730,80,813,107"/>
<area shape="rect" href="dfu_8h.html" title="Header file for iSensor&#45;SPI&#45;Buffer runtime firmware upgrade module." alt="" coords="655,80,706,107"/>
<area shape="rect" href="dio_8h.html" title="Header file for iSensor&#45;SPI&#45;Buffer DIO interfacing module." alt="" coords="949,155,999,181"/>
<area shape="rect" href="timer_8h.html" title="Header file for iSensor&#45;SPI&#45;Buffer timer module." alt="" coords="108,80,171,107"/>
<area shape="rect" href="user__interrupt_8h.html" title="Header file for iSensor&#45;SPI&#45;Buffer user interrupt (data ready) config and generation functions." alt="" coords="195,80,307,107"/>
<area shape="rect" href="isr_8h.html" title="Header file for the interrupt service routine module." alt="" coords="332,80,379,107"/>
<area shape="rect" title=" " alt="" coords="481,155,547,181"/>
<area shape="rect" href="main_8h.html" title="Header file for iSensor&#45;SPI&#45;Buffer main." alt="" coords="834,155,895,181"/>
<area shape="rect" title=" " alt="" coords="806,229,923,256"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2ea4f0af5f4a2eb7d525810686c24c06"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="reg_8c.html#a2ea4f0af5f4a2eb7d525810686c24c06">ProcessRegWrite</a> (uint8_t regAddr, uint8_t regValue)</td></tr>
<tr class="memdesc:a2ea4f0af5f4a2eb7d525810686c24c06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process a write to the iSensor-SPI-Buffer registers.  <a href="reg_8c.html#a2ea4f0af5f4a2eb7d525810686c24c06">More...</a><br /></td></tr>
<tr class="separator:a2ea4f0af5f4a2eb7d525810686c24c06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46941ae03c5cba06f24bbe10ba29eefa"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="reg_8c.html#a46941ae03c5cba06f24bbe10ba29eefa">GetSN</a> ()</td></tr>
<tr class="memdesc:a46941ae03c5cba06f24bbe10ba29eefa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Populates the six SN registers automatically.  <a href="reg_8c.html#a46941ae03c5cba06f24bbe10ba29eefa">More...</a><br /></td></tr>
<tr class="separator:a46941ae03c5cba06f24bbe10ba29eefa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ebca895ecd4473a57471eea92563da3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="reg_8c.html#a3ebca895ecd4473a57471eea92563da3">GetBuildDate</a> ()</td></tr>
<tr class="memdesc:a3ebca895ecd4473a57471eea92563da3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Populates the firmware date registers automatically.  <a href="reg_8c.html#a3ebca895ecd4473a57471eea92563da3">More...</a><br /></td></tr>
<tr class="separator:a3ebca895ecd4473a57471eea92563da3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14ed4a1cae26c8ac3894c10699180a6f"><td class="memItemLeft" align="right" valign="top">volatile uint16_t g_regs[<a class="el" href="reg_8h.html#a807211953b57b1a3f715e8a4496f3d2d">NUM_REG_PAGES</a> *REG_PER_PAGE]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="reg_8c.html#a14ed4a1cae26c8ac3894c10699180a6f">__attribute__</a> ((aligned(32)))</td></tr>
<tr class="separator:a14ed4a1cae26c8ac3894c10699180a6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21315cbfd72bccb63fdd1e97cea672de"><td class="memItemLeft" align="right" valign="top"><a class="el" href="main_8h.html#af6a258d8f3ee5206d682d799316314b1">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="reg_8c.html#a21315cbfd72bccb63fdd1e97cea672de">Reg_Is_Burst_Read</a> (uint8_t addr)</td></tr>
<tr class="memdesc:a21315cbfd72bccb63fdd1e97cea672de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the requested read is a start of a burst.  <a href="reg_8c.html#a21315cbfd72bccb63fdd1e97cea672de">More...</a><br /></td></tr>
<tr class="separator:a21315cbfd72bccb63fdd1e97cea672de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f2c653fad42a4a3f06951e56c3db4d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="reg_8c.html#a0f2c653fad42a4a3f06951e56c3db4d1">Reg_Init</a> ()</td></tr>
<tr class="memdesc:a0f2c653fad42a4a3f06951e56c3db4d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the register module by loading all saves values from flash.  <a href="reg_8c.html#a0f2c653fad42a4a3f06951e56c3db4d1">More...</a><br /></td></tr>
<tr class="separator:a0f2c653fad42a4a3f06951e56c3db4d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a97e807930ced3ef117034418ce77ba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="reg_8c.html#a5a97e807930ced3ef117034418ce77ba">Reg_Update_Identifiers</a> ()</td></tr>
<tr class="memdesc:a5a97e807930ced3ef117034418ce77ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load SN and date code registers to SRAM.  <a href="reg_8c.html#a5a97e807930ced3ef117034418ce77ba">More...</a><br /></td></tr>
<tr class="separator:a5a97e807930ced3ef117034418ce77ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbdf05badd766af7b1a7eb7983bff816"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="reg_8c.html#abbdf05badd766af7b1a7eb7983bff816">Reg_Buf_Dequeue_To_Outputs</a> ()</td></tr>
<tr class="memdesc:abbdf05badd766af7b1a7eb7983bff816"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dequeues an entry from the buffer and loads it to the primary output registers.  <a href="reg_8c.html#abbdf05badd766af7b1a7eb7983bff816">More...</a><br /></td></tr>
<tr class="separator:abbdf05badd766af7b1a7eb7983bff816"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae990584c59a18c196de2500b5cc81880"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="reg_8c.html#ae990584c59a18c196de2500b5cc81880">Reg_Read</a> (uint8_t regAddr)</td></tr>
<tr class="memdesc:ae990584c59a18c196de2500b5cc81880"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process a register read request (from master)  <a href="reg_8c.html#ae990584c59a18c196de2500b5cc81880">More...</a><br /></td></tr>
<tr class="separator:ae990584c59a18c196de2500b5cc81880"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97f4b6010b00c791d0c06284e1049d15"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="reg_8c.html#a97f4b6010b00c791d0c06284e1049d15">Reg_Write</a> (uint8_t regAddr, uint8_t regValue)</td></tr>
<tr class="memdesc:a97f4b6010b00c791d0c06284e1049d15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process a register write request (from master)  <a href="reg_8c.html#a97f4b6010b00c791d0c06284e1049d15">More...</a><br /></td></tr>
<tr class="separator:a97f4b6010b00c791d0c06284e1049d15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeec4e1a44a0aae8d8ed1aca65c26cdd0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="reg_8c.html#aeec4e1a44a0aae8d8ed1aca65c26cdd0">Reg_Process_Command</a> ()</td></tr>
<tr class="memdesc:aeec4e1a44a0aae8d8ed1aca65c26cdd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes a command register write. This function is called from main loop.  <a href="reg_8c.html#aeec4e1a44a0aae8d8ed1aca65c26cdd0">More...</a><br /></td></tr>
<tr class="separator:aeec4e1a44a0aae8d8ed1aca65c26cdd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd9acef9ca1071004db310b6782af0d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="reg_8c.html#abd9acef9ca1071004db310b6782af0d0">Reg_Factory_Reset</a> ()</td></tr>
<tr class="memdesc:abd9acef9ca1071004db310b6782af0d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load factory default values for all registers, and applies any settings changes.  <a href="reg_8c.html#abd9acef9ca1071004db310b6782af0d0">More...</a><br /></td></tr>
<tr class="separator:abd9acef9ca1071004db310b6782af0d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a105d0f8e37af87acc513085ee420b634"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="reg_8c.html#a105d0f8e37af87acc513085ee420b634">Reg_Button_Handler</a> ()</td></tr>
<tr class="memdesc:a105d0f8e37af87acc513085ee420b634"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for when the user button is pressed.  <a href="reg_8c.html#a105d0f8e37af87acc513085ee420b634">More...</a><br /></td></tr>
<tr class="separator:a105d0f8e37af87acc513085ee420b634"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad7e4dc4b3c39faa7fee4573f1664aee2"><td class="memItemLeft" align="right" valign="top">volatile uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="reg_8c.html#ad7e4dc4b3c39faa7fee4573f1664aee2">g_update_flags</a> = 0</td></tr>
<tr class="separator:ad7e4dc4b3c39faa7fee4573f1664aee2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac514950ea85e080587ac1d5fa432f219"><td class="memItemLeft" align="right" valign="top">volatile uint16_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="reg_8c.html#ac514950ea85e080587ac1d5fa432f219">g_CurrentBufEntry</a></td></tr>
<tr class="separator:ac514950ea85e080587ac1d5fa432f219"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a954f038896c833cf36970b00a32329ac"><td class="memItemLeft" align="right" valign="top">static volatile uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="reg_8c.html#a954f038896c833cf36970b00a32329ac">selected_page</a> = <a class="el" href="reg_8h.html#af9e2cac6aba29082e8e722c945b8c935">BUF_CONFIG_PAGE</a></td></tr>
<tr class="separator:a954f038896c833cf36970b00a32329ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>iSensor-SPI-Buffer register interfacing module. Called by user SPI and USB CLI </p>
<p>Copyright (c) Analog Devices Inc, 2020 All Rights Reserved.</p>
<dl class="section date"><dt>Date</dt><dd>3/18/2020 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>A. Nolan (<a href="#" onclick="location.href='mai'+'lto:'+'ale'+'x.'+'nol'+'an'+'@an'+'al'+'og.'+'co'+'m'; return false;">alex.<span style="display: none;">.nosp@m.</span>nola<span style="display: none;">.nosp@m.</span>n@ana<span style="display: none;">.nosp@m.</span>log.<span style="display: none;">.nosp@m.</span>com</a>) </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a14ed4a1cae26c8ac3894c10699180a6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14ed4a1cae26c8ac3894c10699180a6f">&#9670;&nbsp;</a></span>__attribute__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint16_t g_regs [<a class="el" href="reg_8h.html#a807211953b57b1a3f715e8a4496f3d2d">NUM_REG_PAGES</a> * REG_PER_PAGE] __attribute__ </td>
          <td>(</td>
          <td class="paramtype">(aligned(32))&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>iSensor-SPI-Buffer global register array (read-able via SPI). Global scope </p>

</div>
</div>
<a id="a3ebca895ecd4473a57471eea92563da3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ebca895ecd4473a57471eea92563da3">&#9670;&nbsp;</a></span>GetBuildDate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void GetBuildDate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Populates the firmware date registers automatically. </p>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<p>Registers are populated by parsing the <b>DATE</b> macro result, which is set at compile time </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="reg_8c_a3ebca895ecd4473a57471eea92563da3_icgraph.png" border="0" usemap="#areg_8c_a3ebca895ecd4473a57471eea92563da3_icgraph" alt=""/></div>
<map name="reg_8c_a3ebca895ecd4473a57471eea92563da3_icgraph" id="reg_8c_a3ebca895ecd4473a57471eea92563da3_icgraph">
<area shape="rect" title="Populates the firmware date registers automatically." alt="" coords="424,5,523,32"/>
<area shape="rect" href="reg_8c.html#a5a97e807930ced3ef117034418ce77ba" title="Load SN and date code registers to SRAM." alt="" coords="221,5,376,32"/>
<area shape="rect" href="reg_8c.html#a0f2c653fad42a4a3f06951e56c3db4d1" title="Initialize the register module by loading all saves values from flash." alt="" coords="104,5,173,32"/>
<area shape="rect" href="main_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4" title="The application entry point." alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<a id="a46941ae03c5cba06f24bbe10ba29eefa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46941ae03c5cba06f24bbe10ba29eefa">&#9670;&nbsp;</a></span>GetSN()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void GetSN </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Populates the six SN registers automatically. </p>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<p>The SN registers are populated from the 96-bit unique ID (UID) </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="reg_8c_a46941ae03c5cba06f24bbe10ba29eefa_icgraph.png" border="0" usemap="#areg_8c_a46941ae03c5cba06f24bbe10ba29eefa_icgraph" alt=""/></div>
<map name="reg_8c_a46941ae03c5cba06f24bbe10ba29eefa_icgraph" id="reg_8c_a46941ae03c5cba06f24bbe10ba29eefa_icgraph">
<area shape="rect" title="Populates the six SN registers automatically." alt="" coords="424,5,485,32"/>
<area shape="rect" href="reg_8c.html#a5a97e807930ced3ef117034418ce77ba" title="Load SN and date code registers to SRAM." alt="" coords="221,5,376,32"/>
<area shape="rect" href="reg_8c.html#a0f2c653fad42a4a3f06951e56c3db4d1" title="Initialize the register module by loading all saves values from flash." alt="" coords="104,5,173,32"/>
<area shape="rect" href="main_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4" title="The application entry point." alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<a id="a2ea4f0af5f4a2eb7d525810686c24c06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ea4f0af5f4a2eb7d525810686c24c06">&#9670;&nbsp;</a></span>ProcessRegWrite()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t ProcessRegWrite </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>regAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>regValue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process a write to the iSensor-SPI-Buffer registers. </p>
<dl class="section return"><dt>Returns</dt><dd>The index to the register within the global register array</dd></dl>
<p>This function handles filtering for read-only registers. It also handles setting the deferred processing flags as needed for any config/command register writes. This are processed on the next pass of the main loop. </p>

</div>
</div>
<a id="abbdf05badd766af7b1a7eb7983bff816"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbdf05badd766af7b1a7eb7983bff816">&#9670;&nbsp;</a></span>Reg_Buf_Dequeue_To_Outputs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Reg_Buf_Dequeue_To_Outputs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dequeues an entry from the buffer and loads it to the primary output registers. </p>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<p>This function is called from the main loop to preserve SPI responsiveness while a buffer entry is being dequeued into the output registers. This allows a user to read the buffer contents while the values are being moved (if they start reading at buffer entry 0). After moving all values to the correct location in the output register array, the function sets up the burst read DMA (if enabled in user SPI config). </p>

</div>
</div>
<a id="a105d0f8e37af87acc513085ee420b634"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a105d0f8e37af87acc513085ee420b634">&#9670;&nbsp;</a></span>Reg_Button_Handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Reg_Button_Handler </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handler for when the user button is pressed. </p>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<p>This function executes commands based on the button configuration set in BTN_CONFIG. This function can be called from an interrupt context (EXTI rising edge interrupt for button). The EXTI pending interrupt register for the button line should be cleared before and after executing this function to add some implicit debouncing (interrupt won't trigger, then immediately trigger again). </p>

</div>
</div>
<a id="abd9acef9ca1071004db310b6782af0d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd9acef9ca1071004db310b6782af0d0">&#9670;&nbsp;</a></span>Reg_Factory_Reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Reg_Factory_Reset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load factory default values for all registers, and applies any settings changes. </p>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<p>This is accomplished in "lazy" manner via a preprocessor define for each register default value (defaults are stored in program memory, storage is managed by compiler). This function only changes values in SRAM, does not change flash contents (registers will reset on next re-boot). </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="reg_8c_abd9acef9ca1071004db310b6782af0d0_cgraph.png" border="0" usemap="#areg_8c_abd9acef9ca1071004db310b6782af0d0_cgraph" alt=""/></div>
<map name="reg_8c_abd9acef9ca1071004db310b6782af0d0_cgraph" id="reg_8c_abd9acef9ca1071004db310b6782af0d0_cgraph">
<area shape="rect" title="Load factory default values for all registers, and applies any settings changes." alt="" coords="5,5,143,32"/>
<area shape="rect" href="data__capture_8c.html#a092ba93a71cecfb33d6ae112eeb2f5c0" title="disables autonomous data capture by disabling DR ISR." alt="" coords="191,5,341,32"/>
<area shape="rect" href="led_8c.html#ac5d6499055e5e7cd2d5425cbf404c32e" title="Turn off a selected LED." alt="" coords="389,5,492,32"/>
</map>
</div>

</div>
</div>
<a id="a0f2c653fad42a4a3f06951e56c3db4d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f2c653fad42a4a3f06951e56c3db4d1">&#9670;&nbsp;</a></span>Reg_Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Reg_Init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the register module by loading all saves values from flash. </p>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<p>Most register values are loaded directly from the flash register array. Some values (SN and FW date) are encoded into the code, and must be loaded separately using Update_Identifiers() </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="reg_8c_a0f2c653fad42a4a3f06951e56c3db4d1_cgraph.png" border="0" usemap="#areg_8c_a0f2c653fad42a4a3f06951e56c3db4d1_cgraph" alt=""/></div>
<map name="reg_8c_a0f2c653fad42a4a3f06951e56c3db4d1_cgraph" id="reg_8c_a0f2c653fad42a4a3f06951e56c3db4d1_cgraph">
<area shape="rect" title="Initialize the register module by loading all saves values from flash." alt="" coords="5,31,75,57"/>
<area shape="rect" href="flash_8c.html#a2fe1dea04eb80abcf236bc42ca5197b6" title="Load register values from flash memory to SRAM." alt="" coords="125,5,275,32"/>
<area shape="rect" href="reg_8c.html#a5a97e807930ced3ef117034418ce77ba" title="Load SN and date code registers to SRAM." alt="" coords="123,56,277,83"/>
<area shape="rect" href="reg_8c.html#a3ebca895ecd4473a57471eea92563da3" title="Populates the firmware date registers automatically." alt="" coords="325,31,424,57"/>
<area shape="rect" href="reg_8c.html#a46941ae03c5cba06f24bbe10ba29eefa" title="Populates the six SN registers automatically." alt="" coords="344,81,405,108"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="reg_8c_a0f2c653fad42a4a3f06951e56c3db4d1_icgraph.png" border="0" usemap="#areg_8c_a0f2c653fad42a4a3f06951e56c3db4d1_icgraph" alt=""/></div>
<map name="reg_8c_a0f2c653fad42a4a3f06951e56c3db4d1_icgraph" id="reg_8c_a0f2c653fad42a4a3f06951e56c3db4d1_icgraph">
<area shape="rect" title="Initialize the register module by loading all saves values from flash." alt="" coords="104,5,173,32"/>
<area shape="rect" href="main_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4" title="The application entry point." alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<a id="a21315cbfd72bccb63fdd1e97cea672de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21315cbfd72bccb63fdd1e97cea672de">&#9670;&nbsp;</a></span>Reg_Is_Burst_Read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="main_8h.html#af6a258d8f3ee5206d682d799316314b1">bool</a> Reg_Is_Burst_Read </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>addr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if the requested read is a start of a burst. </p>
<dl class="section return"><dt>Returns</dt><dd>true if burst starting, false otherwise</dd></dl>
<p>For a burst to start, the buffer read page must be selected, the address must be BUF_RETRIEVE, and buffer burst mode must be enabled. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="reg_8c_a21315cbfd72bccb63fdd1e97cea672de_icgraph.png" border="0" usemap="#areg_8c_a21315cbfd72bccb63fdd1e97cea672de_icgraph" alt=""/></div>
<map name="reg_8c_a21315cbfd72bccb63fdd1e97cea672de_icgraph" id="areg_8c_a21315cbfd72bccb63fdd1e97cea672de_icgraph">
<area shape="rect" title="Check if the requested read is a start of a burst." alt="" coords="176,5,313,32"/>
<area shape="rect" href="isr_8c.html#a68d8880cd80cb17a2501487c3d649ea1" title="This function handles the user SPI (SPI2) rx data interrupt." alt="" coords="5,5,128,32"/>
</map>
</div>

</div>
</div>
<a id="aeec4e1a44a0aae8d8ed1aca65c26cdd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeec4e1a44a0aae8d8ed1aca65c26cdd0">&#9670;&nbsp;</a></span>Reg_Process_Command()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Reg_Process_Command </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processes a command register write. This function is called from main loop. </p>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<p>Only one command can be executed per write to the USER_COMMAND register. Command execution priority is determined by the order in which the command flags are checked. </p>

</div>
</div>
<a id="ae990584c59a18c196de2500b5cc81880"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae990584c59a18c196de2500b5cc81880">&#9670;&nbsp;</a></span>Reg_Read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t Reg_Read </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>regAddr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process a register read request (from master) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">regAddr</td><td>The byte address of the register to read</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Value of register requested</dd></dl>
<p>For selected pages not addressed by iSensor-SPI-Buffer, the read is passed through to the connected IMU, using the spi_passthrough module. If the selected page is [253 - 255] this read request is processed directly. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="reg_8c_ae990584c59a18c196de2500b5cc81880_icgraph.png" border="0" usemap="#areg_8c_ae990584c59a18c196de2500b5cc81880_icgraph" alt=""/></div>
<map name="reg_8c_ae990584c59a18c196de2500b5cc81880_icgraph" id="areg_8c_ae990584c59a18c196de2500b5cc81880_icgraph">
<area shape="rect" title="Process a register read request (from master)" alt="" coords="416,31,499,57"/>
<area shape="rect" href="isr_8c.html#a9f205735b8aa53aa3809d7a1ad2d81c9" title="Process a 16 bit data word from the user SPI." alt="" coords="209,5,368,32"/>
<area shape="rect" href="script_8c.html#ac667819c6a60b19091561cb8a62e0f2b" title="Read command handler." alt="" coords="241,56,337,83"/>
<area shape="rect" href="isr_8c.html#a738473a5b43f6c92b80ce1d3d6f77ed9" title="This function handles the user SPI (SPI2) chip select rising edge." alt="" coords="5,5,161,32"/>
</map>
</div>

</div>
</div>
<a id="a5a97e807930ced3ef117034418ce77ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a97e807930ced3ef117034418ce77ba">&#9670;&nbsp;</a></span>Reg_Update_Identifiers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Reg_Update_Identifiers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load SN and date code registers to SRAM. </p>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<p>These register values are encoded into the .text section of flash </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="reg_8c_a5a97e807930ced3ef117034418ce77ba_cgraph.png" border="0" usemap="#areg_8c_a5a97e807930ced3ef117034418ce77ba_cgraph" alt=""/></div>
<map name="reg_8c_a5a97e807930ced3ef117034418ce77ba_cgraph" id="reg_8c_a5a97e807930ced3ef117034418ce77ba_cgraph">
<area shape="rect" title="Load SN and date code registers to SRAM." alt="" coords="5,31,160,57"/>
<area shape="rect" href="reg_8c.html#a3ebca895ecd4473a57471eea92563da3" title="Populates the firmware date registers automatically." alt="" coords="208,5,307,32"/>
<area shape="rect" href="reg_8c.html#a46941ae03c5cba06f24bbe10ba29eefa" title="Populates the six SN registers automatically." alt="" coords="227,56,288,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="reg_8c_a5a97e807930ced3ef117034418ce77ba_icgraph.png" border="0" usemap="#areg_8c_a5a97e807930ced3ef117034418ce77ba_icgraph" alt=""/></div>
<map name="reg_8c_a5a97e807930ced3ef117034418ce77ba_icgraph" id="reg_8c_a5a97e807930ced3ef117034418ce77ba_icgraph">
<area shape="rect" title="Load SN and date code registers to SRAM." alt="" coords="221,5,376,32"/>
<area shape="rect" href="reg_8c.html#a0f2c653fad42a4a3f06951e56c3db4d1" title="Initialize the register module by loading all saves values from flash." alt="" coords="104,5,173,32"/>
<area shape="rect" href="main_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4" title="The application entry point." alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<a id="a97f4b6010b00c791d0c06284e1049d15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97f4b6010b00c791d0c06284e1049d15">&#9670;&nbsp;</a></span>Reg_Write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t Reg_Write </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>regAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>regValue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process a register write request (from master) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">regAddr</td><td>The address of the register to write to</td></tr>
    <tr><td class="paramname">regValue</td><td>The value to write to the register</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The contents of the register being written, after write is processed</dd></dl>
<p>For selected pages not addressed by iSensor-SPI-Buffer, the write is passed through to the connected IMU, using the spi_passthrough module. If the selected page is [252 - 255] this write request is processed directly. The firmware echoes back the processed write value so that the master can verify the write contents on the next SPI transaction. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="reg_8c_a97f4b6010b00c791d0c06284e1049d15_icgraph.png" border="0" usemap="#areg_8c_a97f4b6010b00c791d0c06284e1049d15_icgraph" alt=""/></div>
<map name="reg_8c_a97f4b6010b00c791d0c06284e1049d15_icgraph" id="areg_8c_a97f4b6010b00c791d0c06284e1049d15_icgraph">
<area shape="rect" title="Process a register write request (from master)" alt="" coords="416,31,499,57"/>
<area shape="rect" href="isr_8c.html#a9f205735b8aa53aa3809d7a1ad2d81c9" title="Process a 16 bit data word from the user SPI." alt="" coords="209,5,368,32"/>
<area shape="rect" href="script_8c.html#a84be1b50cabc1d7855f02d66a171a92e" title="Write command handler." alt="" coords="240,56,337,83"/>
<area shape="rect" href="isr_8c.html#a738473a5b43f6c92b80ce1d3d6f77ed9" title="This function handles the user SPI (SPI2) chip select rising edge." alt="" coords="5,5,161,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ac514950ea85e080587ac1d5fa432f219"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac514950ea85e080587ac1d5fa432f219">&#9670;&nbsp;</a></span>g_CurrentBufEntry</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint16_t* g_CurrentBufEntry</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pointer to buffer entry. Will be 0 if no buffer entry "loaded" to output registers </p>

</div>
</div>
<a id="ad7e4dc4b3c39faa7fee4573f1664aee2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7e4dc4b3c39faa7fee4573f1664aee2">&#9670;&nbsp;</a></span>g_update_flags</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint32_t g_update_flags = 0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Register update flags for main loop processing. Global scope </p>

</div>
</div>
<a id="a954f038896c833cf36970b00a32329ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a954f038896c833cf36970b00a32329ac">&#9670;&nbsp;</a></span>selected_page</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint32_t selected_page = <a class="el" href="reg_8h.html#af9e2cac6aba29082e8e722c945b8c935">BUF_CONFIG_PAGE</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Selected page. Starts on 253 (config page) </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
